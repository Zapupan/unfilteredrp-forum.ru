# Настройка автозапуска сервера через CRON

## Шаг 1: Загрузите скрипт на сервер

Загрузите файл `start-server.sh` на сервер в папку `/var/www/u3372230/data/`

## Шаг 2: Сделайте скрипт исполняемым

В Shell-клиенте выполните:
```bash
cd /var/www/u3372230/data
chmod +x start-server.sh
```

## Шаг 3: Настройте CRON задачу

1. В панели управления хостингом откройте **"Планировщик CRON"**
2. Нажмите **"Добавить задачу"** или **"Создать"**
3. Настройте задачу:

**Команда:**
```bash
/var/www/u3372230/data/start-server.sh
```

**Расписание:**
- **Каждую минуту:** `* * * * *`
- **Каждые 5 минут:** `*/5 * * * *` (рекомендуется)
- **Каждые 10 минут:** `*/10 * * * *`

**Рекомендация:** Используйте `*/5 * * * *` (каждые 5 минут) - это обеспечит быстрый перезапуск при сбое, но не будет слишком нагружать систему.

## Шаг 4: Проверка работы

После настройки CRON:
1. Подождите 5 минут
2. Проверьте, запущен ли сервер:
```bash
ps aux | grep server-mysql.js
```

Или проверьте логи:
```bash
tail -f /var/www/u3372230/data/server.log
```

## Управление сервером

**Остановить сервер:**
```bash
cd /var/www/u3372230/data
if [ -f server.pid ]; then
    kill $(cat server.pid)
    rm server.pid
fi
```

**Перезапустить сервер:**
```bash
cd /var/www/u3372230/data
if [ -f server.pid ]; then
    kill $(cat server.pid)
    rm server.pid
fi
./start-server.sh
```

**Посмотреть логи:**
```bash
tail -f /var/www/u3372230/data/server.log
```

## Что делает скрипт?

1. ✅ Проверяет, запущен ли уже сервер (по PID файлу)
2. ✅ Если не запущен - запускает сервер в фоновом режиме
3. ✅ Сохраняет PID процесса для последующих проверок
4. ✅ Записывает логи в `server.log`
5. ✅ Безопасно обрабатывает ошибки

## Важно!

- CRON будет проверять и запускать сервер каждые 5 минут
- Если сервер уже работает - ничего не произойдет
- Если сервер упал - он автоматически перезапустится в течение 5 минут
- Все логи сохраняются в `server.log`

